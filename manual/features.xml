<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE chapter SYSTEM "docbook-dtd-45/docbookx.dtd">

<chapter id="features">
  <title>Feature Additions &amp; Changes</title>

  <section id="sections">
    <title>Sections</title>

    <para>
      CG-2 has three seperate grammar sections: <glossterm linkend="keyword-sets">SETS</glossterm>,
      <glossterm linkend="keyword-mappings">MAPPINGS</glossterm>, and <glossterm linkend="keyword-constraints">CONSTRAINTS</glossterm>
      VISLCG added to these with the <glossterm linkend="keyword-corrections">CORRECTIONS</glossterm> section.
      Each of these can only contain certain definitions, such as LIST, MAP, or SELECT.
      As I understand it, this was due to the original CG parser being written in a language
      that needed such a format. In any case, I did not see the logic or usability in
      such a strict format. VISL CG-3 has a single section header <glossterm linkend="keyword-section">SECTION</glossterm>, which can contain
      any of the set or rule definitions. Sections can also be given a name for easier
      identification and anchor behavior, but that is optional. The older section
      headings are still valid and will work as expected, though.
    </para>
    <para>
      By allowing any set or rule definition anywhere you could write a grammar such as:
      <screen>
        DELIMITERS = "&lt;$.&gt;" ;
        LIST ThisIsASet = "&lt;sometag&gt;" "&lt;othertag&gt;" ;

        SECTION
        LIST ThisIsAlsoASet = atag btag ctag ;
        SET Hubba =  ThisIsASet â€“ (ctag) ;
        SELECT ThisIsASet IF (-1 (dtag)) ;
        LIST AnotherSet =  "&lt;youknowthedrill&gt;" ;

        MAP (@bingo) TARGET AnotherSet ;
      </screen>
    </para>

    <para>
      Notice that the first LIST ThisIsASet is outside a section.
      This is because sets are considered global regardless of where
      they are declared and can as such be declared anywhere, even before the
      DELIMITERS declaration should you so desire1. A side effect of this is
      that set names must be unique across the entire grammar, but as this is
      also the behavior of CG-2 and VISLCG that should not be a surprise nor problem.
    </para>

    <para>
      Rules are applied in the order they are declared. In the above example
      that would execute SELECT first and then the MAP rule.
    </para>

  </section>

</chapter>